<link rel="import" href="../../bower_components/polymer/polymer.html">
<script src="../js/escaping.js"></script>
<polymer-element name="viewer-element" attributes="css html">
	<template>
		<iframe id="iframe" >
		</iframe>
        <style>
            iframe {
                width:100%; 
                height:100%;   
                display: block;
                border: 0;
                margin: 0;
            }
        </style>

	</template>
 	<script>
		Polymer({
			created: function() {
				this.html = "";
				this.css = "";
			},
			
		
			contentChanged: function(){
				console.log(this.html)
  				var doc = this.$.iframe.contentWindow.document;
                var content = htmlEscape.unescape(this.html);
                console.log(content);
                console.log(doc.styleSheets);
                doc.open();
                doc.write(content);
                doc.close();
				console.log(this.css)
                console.log(htmlEscape.unescape(this.css));
                var node = doc.createElement('style');
                var el = document.createElement( 'div' );
                el.innerHTML = htmlEscape.unescape(this.css).replace(/&nbsp;/g, " "); 

                node.innerHTML =  el.textContent;
                doc.head.appendChild(node);

			
			},
			observe: {
               'html': 'contentChanged',
               'css': 'contentChanged',
            }

		  
		});
	</script>
</polymer-element>

